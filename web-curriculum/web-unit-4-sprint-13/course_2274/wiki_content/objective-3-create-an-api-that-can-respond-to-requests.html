<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Objective 3 - Create an API That Can Respond to Requests</title>
<meta name="identifier" content="g9f4ec059a4436189d1abf829a1b18244"/>
<meta name="editing_roles" content="teachers"/>
<meta name="workflow_state" content="active"/>
</head>
<body>
<p>&nbsp;</p>
<p><iframe class="wistia_embed" title="Node and Express Video" src="https://fast.wistia.net/embed/iframe/xld7g7jflu" width="640" height="360" name="wistia_embed" allow="autoplay; fullscreen" loading="lazy"></iframe></p>
<p>&nbsp;</p>
<h2 id="overview">Overview</h2>
<p><span>In this overview, we're walking through the steps necessary to build a simple Web API that returns the string "Hello World" on every incoming GET request. The program should return the string every time a request comes into the root route ("/"). For now, you don't need to code along, just read through the steps.</span></p>
<p><span>To make things easier, we'll use an existing repository as the base for our API. Then, later in the week, as we learn more about Node.js and Express, we'll create an API from scratch.</span></p>
<p><span>To build our first API, we will:</span></p>
<ol>
<li>clone the <a href="https://github.com/lambdaschool/node-express-mini">node-express-mini repository</a> to a folder on our computer.</li>
<li>Navigate into the folder using <code>cd</code>.</li>
<li>Use <code>npm install</code> to download all dependencies.</li>
<li>Add a file called <code>index.js</code> at the folder's root, next to the <code>package.json</code> file.</li>
<li>Open the <code>index.js</code> file using our favorite code editor.</li>
<li>Add the following code:</li>
</ol>
<pre style="background-image: none; background-attachment: scroll; background-color: #ffffff; border: 1px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font-style: normal; font-stretch: normal; font-size: 12px; line-height: 14.4px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px; background-position: 0% 0%; background-repeat: repeat repeat;" data-hljs-language="javascript"><code style="background-image: none; background-attachment: scroll; background-color: rgba(0, 0, 0, 0); border: 0px none #24292e; font-style: normal; font-stretch: normal; font-size: 16px; line-height: 19.200001px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px; background-position: 0% 0%; background-repeat: repeat repeat;"><span style="border: 0px none #6a737d; color: #6a737d;">// require the express npm module, needs to be added to the project using "npm install express"</span><br><span style="border: 0px none #d73a49; color: #d73a49;">const</span> express = <span style="border: 0px none #e36209; color: #e36209;">require</span>(<span style="border: 0px none #032f62; color: #032f62;">'express'</span>);<br><br><span style="border: 0px none #6a737d; color: #6a737d;">// creates an express application using the express module</span><br><span style="border: 0px none #d73a49; color: #d73a49;">const</span> server = <span style="border: 0px none #6f42c1; color: #6f42c1;">express</span>();<br><br><span style="border: 0px none #6a737d; color: #6a737d;">// configures our server to execute a function for every GET request to "/"</span><br><span style="border: 0px none #6a737d; color: #6a737d;">// the second argument passed to the .get() method is the "Route Handler Function"</span><br><span style="border: 0px none #6a737d; color: #6a737d;">// the route handler function will run on every GET request to "/"</span><br>server.<span style="border: 0px none #6f42c1; color: #6f42c1;">get</span>(<span style="border: 0px none #032f62; color: #032f62;">'/'</span>, <span>(<span>req, res</span>) =&gt;</span> {<br>&nbsp;&nbsp;<span style="border: 0px none #6a737d; color: #6a737d;">// express will pass the request and response objects to this function</span><br>&nbsp;&nbsp;<span style="border: 0px none #6a737d; color: #6a737d;">// the .send() on the response object can be used to send a response to the client</span><br>&nbsp;&nbsp;res.<span style="border: 0px none #6f42c1; color: #6f42c1;">send</span>(<span style="border: 0px none #032f62; color: #032f62;">'Hello World'</span>);<br>});<br><br><span style="border: 0px none #6a737d; color: #6a737d;">// once the server is fully configured we can have it "listen" for connections on a particular "port"</span><br><span style="border: 0px none #6a737d; color: #6a737d;">// the callback function passed as the second argument will run once when the server starts</span><br>server.<span style="border: 0px none #6f42c1; color: #6f42c1;">listen</span>(<span style="border: 0px none #005cc5; color: #005cc5;">8000</span>, <span>() =&gt;</span> <span style="border: 0px none #d73a49; color: #d73a49;">console</span>.<span style="border: 0px none #6f42c1; color: #6f42c1;">log</span>(<span style="border: 0px none #032f62; color: #032f62;">'API running on port 8000'</span>));</code></pre>
<p><strong>make sure to save your changes to <code>index.js</code>.</strong></p>
<p>We are using the <code>express</code> npm module in our code, so we need to add it as a dependency to our project. To do this:</p>
<ul>
<li>Open a terminal/console/command prompt window and navigate to the root of our project.</li>
<li>Add express to our <code>package.json</code> file by typing <code>npm install express</code>.</li>
</ul>
<p>Now we're ready to test our API!</p>
<p>In the terminal, still at the root of our project:</p>
<ul>
<li>Type: <code>npm run server</code> to run our API. The message <em>"Api running on port 8000"</em> should appear on the terminal.</li>
<li aria-level="1"><span>Open a web browser and navigate to "http://localhost:8000".</span></li>
</ul>
<p><span>There we have it, our first API!</span></p>
<p><span>A lot is going on in those few lines of code (only six lines if we remove the comments and white space). We will cover every piece of it in detail over the following modules, but here is a quick rundown of the most important concepts.</span></p>
<p>First, we used <code>require()</code> to <strong>import</strong> the <code>express module</code> and make it available to our application. <code>require()</code> is similar to the <code>import</code> keyword we have used before. The line <code>const express = require('express');</code> is equivalent to <code>import express from 'express';</code> if we were using ES2015 syntax.</p>
<p>The following line creates our Express application. The return of calling <code>express()</code>&nbsp;<span>is an Express application that we can use to configure our server and, eventually, start listening for and responding to requests. Notice we use the word server, not API. An Express application is generic, which means we can use it to serve static content (HTML, CSS, audio, video, PDFs, and more). We can also use an Express application to serve dynamically generated web pages, build real-time communications servers, and more. Finally, we will use it statically to accept requests from clients and respond with data in JSON format.</span></p>
<p>An Express application publishes a set of methods we can use to configure functions. We are using the <code>.get()</code> method to set up a <strong>route handler</strong> function that will run on every <code>GET</code> request. As a part of this handler function, we specify the URL which will trigger the request. In this case, the URL is the site's root (represented by a <code>/</code>). There are also methods to handle the <code>POST</code>, <code>PUT</code>, and <code>DELETE</code> HTTP verbs.</p>
<p>The first two arguments passed by <code>express</code> to a route handler function are 1) an object representing the <code>request</code> and 2) an object representing the <code>response</code>. Express expands those objects with a set of useful properties and methods. Our example uses the <code>.send()</code> method of the response object to specify the data we will send to the client as the response body. You can call the first two arguments anything you want, but it is prevalent to see them dubbed <code>req</code> and <code>res</code>. We at BloomTech call them <strong>the homies</strong> as they always hang out together.</p>
<p><span>That's all the configuring we need to do for this first example. We'll see other ways of configuring our server as we go forward.</span></p>
<p>After configuring the server, it's time to turn it on. We use the <code>.listen()</code> method to monitor a port on the computer for any incoming connections and respond to those we have configured. Our server will only respond to <code>GET</code> requests made to the <code>/</code> route on port <code>8000</code>.</p>
<p><span>That's it for our first Web API, and now it's time for you to follow along as we add a new <strong>endpoint</strong> to our server that returns JSON data!</span></p>
<h2 id="follow-along">Follow Along</h2>
<p><span>Let's try returning JSON instead of just a simple string.</span></p>
<p>Please follow the steps outlined on the overview, but, to save time, copy and paste the content of <code>index.js</code> instead of typing it. Then run your API through a browser to make sure it works.</p>
<p><span>Now follow along as we code a new <em>endpoint</em> that returns an array of movie characters in JSON format.</span></p>
<p>The first step is to define a new <em>route handler</em> to respond to <code>GET</code> requests at the <code>/hobbits</code> endpoint.</p>
<pre style="background-image: none; background-attachment: scroll; background-color: #ffffff; border: 1px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font-style: normal; font-stretch: normal; font-size: 12px; line-height: 14.4px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px; background-position: 0% 0%; background-repeat: repeat repeat;" data-hljs-language="javascript"><code style="background-image: none; background-attachment: scroll; background-color: rgba(0, 0, 0, 0); border: 0px none #24292e; font-style: normal; font-stretch: normal; font-size: 16px; line-height: 19.200001px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px; background-position: 0% 0%; background-repeat: repeat repeat;">server.<span style="border: 0px none #6f42c1; color: #6f42c1;">get</span>(<span style="border: 0px none #032f62; color: #032f62;">'/hobbits'</span>, <span>(<span>req, res</span>) =&gt;</span> {<br>&nbsp;&nbsp;<span style="border: 0px none #6a737d; color: #6a737d;">// route handler code here</span><br>});</code></pre>
<p><span>Next, we define the return data that our endpoint will send back to the client. We do this inside the newly defined route handler function.</span></p>
<pre style="background-image: none; background-attachment: scroll; background-color: #ffffff; border: 1px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font-style: normal; font-stretch: normal; font-size: 12px; line-height: 14.4px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px; background-position: 0% 0%; background-repeat: repeat repeat;" data-hljs-language="javascript"><code style="background-image: none; background-attachment: scroll; background-color: rgba(0, 0, 0, 0); border: 0px none #24292e; font-style: normal; font-stretch: normal; font-size: 16px; line-height: 19.200001px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px; background-position: 0% 0%; background-repeat: repeat repeat;"><span style="border: 0px none #d73a49; color: #d73a49;">const</span> hobbits = [<br>&nbsp;&nbsp;&nbsp;&nbsp;{ <span style="border: 0px none #005cc5; color: #005cc5;">id</span>: <span style="border: 0px none #005cc5; color: #005cc5;">1</span>, <span style="border: 0px none #005cc5; color: #005cc5;">name</span>: <span style="border: 0px none #032f62; color: #032f62;">'Samwise Gamgee'</span> },<br>&nbsp;&nbsp;&nbsp;&nbsp;{ <span style="border: 0px none #005cc5; color: #005cc5;">id</span>: <span style="border: 0px none #005cc5; color: #005cc5;">2</span>, <span style="border: 0px none #005cc5; color: #005cc5;">name</span>: <span style="border: 0px none #032f62; color: #032f62;">'Frodo Baggins'</span> },<br>];</code></pre>
<p>Now we can return the <code>hobbits</code> array. We could use <code>.send(hobbits)</code> as we did for the string on the <code>/</code> endpoint, but this time we'll learn about two other useful methods we find in the response object.</p>
<pre style="background-image: none;  background-attachment: scroll;   background-color: #ffffff; border: 1px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font-style: normal;   font-stretch: normal; font-size: 12px; line-height: 14.4px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px;      background-position: 0% 0%; background-repeat: repeat repeat;" data-hljs-language="javascript"><code style="background-image: none;  background-attachment: scroll;   background-color: rgba(0, 0, 0, 0); border: 0px none #24292e; font-style: normal;   font-stretch: normal; font-size: 16px; line-height: 19.200001px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px; background-position: 0% 0%; background-repeat: repeat repeat;">res.<span style="border: 0px none #6f42c1; color: #6f42c1;">status</span>(<span style="border: 0px none #005cc5; color: #005cc5;">200</span>).<span style="border: 0px none #6f42c1; color: #6f42c1;">json</span>(hobbits);</code></pre>
<p>We should provide as much useful information as possible to the clients using our API. One such piece of data is the <code>HTTP status code</code> that reflects the client's operation outcome. In this case, the client is trying to get a list of a particular <code>resource</code>, a <code>hobbits</code> list. Sending back a <code>200 OK</code> status code communicates to the client that the operation was successful.</p>
<p><span>We will see other status codes as we continue to build new endpoints during this week. You can see a list by following </span><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status"><span>this link to the documentation about HTTP Response Codes on the Mozilla Developer Network site</span></a></p>
<p>We can use the <code>.status()</code> method of the response object to send any valid <code>HTTP status code</code>.</p>
<p>We are also chaining the <code>.json()</code> method of the response object. We do this to communicate to both the client making the request and the next developer working with this code that we intend to send the data in <code>JSON format</code>.</p>
<p>The complete code for <code>index.js</code> should now look like so:</p>
<pre style="background-image: none; background-attachment: scroll; background-color: #ffffff; border: 1px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font-style: normal; font-stretch: normal; font-size: 12px; line-height: 14.4px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px; background-position: 0% 0%; background-repeat: repeat repeat;" data-hljs-language="javascript"><code style="background-image: none; background-attachment: scroll; background-color: rgba(0, 0, 0, 0); border: 0px none #24292e; font-style: normal; font-stretch: normal; font-size: 16px; line-height: 19.200001px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px; background-position: 0% 0%; background-repeat: repeat repeat;"><span style="border: 0px none #d73a49; color: #d73a49;">const</span> express = <span style="border: 0px none #e36209; color: #e36209;">require</span>(<span style="border: 0px none #032f62; color: #032f62;">'express'</span>);<br><br><span style="border: 0px none #d73a49; color: #d73a49;">const</span> server = <span style="border: 0px none #6f42c1; color: #6f42c1;">express</span>();<br><br>server.<span style="border: 0px none #6f42c1; color: #6f42c1;">get</span>(<span style="border: 0px none #032f62; color: #032f62;">'/'</span>, <span>(<span>req, res</span>) =&gt;</span> {<br>&nbsp;&nbsp;res.<span style="border: 0px none #6f42c1; color: #6f42c1;">send</span>(<span style="border: 0px none #032f62; color: #032f62;">'Hello World'</span>);<br>});<br>server.<span style="border: 0px none #6f42c1; color: #6f42c1;">get</span>(<span style="border: 0px none #032f62; color: #032f62;">'/hobbits'</span>, <span>(<span>req, res</span>) =&gt;</span> {<br>&nbsp;&nbsp;<span style="border: 0px none #d73a49; color: #d73a49;">const</span> hobbits = [<br>&nbsp;&nbsp;&nbsp;&nbsp;{ <span style="border: 0px none #005cc5; color: #005cc5;">id</span>: <span style="border: 0px none #005cc5; color: #005cc5;">1</span>, <span style="border: 0px none #005cc5; color: #005cc5;">name</span>: <span style="border: 0px none #032f62; color: #032f62;">'Samwise Gamgee'</span> },<br>&nbsp;&nbsp;&nbsp;&nbsp;{ <span style="border: 0px none #005cc5; color: #005cc5;">id</span>: <span style="border: 0px none #005cc5; color: #005cc5;">2</span>, <span style="border: 0px none #005cc5; color: #005cc5;">name</span>: <span style="border: 0px none #032f62; color: #032f62;">'Frodo Baggins'</span> },<br>&nbsp;&nbsp;];<br>&nbsp;&nbsp;res.<span style="border: 0px none #6f42c1; color: #6f42c1;">status</span>(<span style="border: 0px none #005cc5; color: #005cc5;">200</span>).<span style="border: 0px none #6f42c1; color: #6f42c1;">json</span>(hobbits);<br>});<br><br>server.<span style="border: 0px none #6f42c1; color: #6f42c1;">listen</span>(<span style="border: 0px none #005cc5; color: #005cc5;">8000</span>, <span>() =&gt;</span> <span style="border: 0px none #d73a49; color: #d73a49;">console</span>.<span style="border: 0px none #6f42c1; color: #6f42c1;">log</span>(<span style="border: 0px none #032f62; color: #032f62;">'API running on port 8000'</span>));<br></code></pre>
<p>Now we can visit <code>http://localhost:8000/hobbits</code> in our browser, and we should get back our JSON array.</p>
<p>If you are using the Google Chrome browser, <a href="https://chrome.google.com/webstore/detail/jsonview/chklaanhfefbnpoihckbnefhakgolnmc">this extension</a> can format the JSON data in a more readable fashion.</p>
<p>Besides GET, there also exist POST (for creating), PUT (for updating or replacing) and DELETE actions we can ask the server to perform. Here is our Hobbits API, expanded to support full CRUD (Create, Read, Update and Delete):</p>
<pre style="background-image: none; background-attachment: scroll; background-color: #ffffff; border: 1px solid #c7cdd1; clear: none; color: #24292e; cursor: auto; direction: ltr; font-style: normal; font-stretch: normal; font-size: 12px; line-height: 14.4px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px 0px 12px; padding: 9px; text-align: start; text-decoration: none; text-indent: 0px; white-space: pre-wrap; border-collapse: separate; border-spacing: 0px; background-position: 0% 0%; background-repeat: repeat repeat;" data-hljs-language="javascript"><code style="background-image: none; background-attachment: scroll; background-color: rgba(0, 0, 0, 0); border: 0px none #24292e; font-style: normal; font-stretch: normal; font-size: 16px; line-height: 19.200001px; font-family: Monaco, Menlo, Consolas, 'Courier New', monospace; margin: 0px; padding: 0px; background-position: 0% 0%; background-repeat: repeat repeat;"><span style="border: 0px none #d73a49; color: #d73a49;">const</span> express = <span style="border: 0px none #e36209; color: #e36209;">require</span>(<span style="border: 0px none #032f62; color: #032f62;">'express'</span>);<br><br><span style="border: 0px none #d73a49; color: #d73a49;">const</span> server = <span style="border: 0px none #6f42c1; color: #6f42c1;">express</span>();<br>server.<span style="border: 0px none #6f42c1; color: #6f42c1;">use</span>(express.<span style="border: 0px none #6f42c1; color: #6f42c1;">json</span>()); <span style="border: 0px none #6a737d; color: #6a737d;">// !! IMPORTANT this teaches express to parse req.body</span><br><br><span style="border: 0px none #d73a49; color: #d73a49;">let</span> id = <span style="border: 0px none #005cc5; color: #005cc5;">0</span><br><span style="border: 0px none #d73a49; color: #d73a49;">let</span> <span style="border: 0px none #6f42c1; color: #6f42c1;">getId</span> = () =&gt; ++id <span style="border: 0px none #6a737d; color: #6a737d;">// helper function to create auto-incrementing ids</span><br><br><span style="border: 0px none #d73a49; color: #d73a49;">let</span> hobbits = [ <span style="border: 0px none #6a737d; color: #6a737d;">// our fake hobbits database table</span><br>&nbsp;&nbsp;{ <span style="border: 0px none #005cc5; color: #005cc5;">id</span>: <span style="border: 0px none #6f42c1; color: #6f42c1;">getId</span>(), <span style="border: 0px none #005cc5; color: #005cc5;">name</span>: <span style="border: 0px none #032f62; color: #032f62;">'Samwise Gamgee'</span> },<br>&nbsp;&nbsp;{ <span style="border: 0px none #005cc5; color: #005cc5;">id</span>: <span style="border: 0px none #6f42c1; color: #6f42c1;">getId</span>(), <span style="border: 0px none #005cc5; color: #005cc5;">name</span>: <span style="border: 0px none #032f62; color: #032f62;">'Frodo Baggins'</span> },<br>];<br><br>server.<span style="border: 0px none #6f42c1; color: #6f42c1;">get</span>(<span style="border: 0px none #032f62; color: #032f62;">'/hobbits'</span>, <span>(<span>req, res</span>) =&gt;</span> { <span style="border: 0px none #6a737d; color: #6a737d;">// GET ALL EXISTING HOBBITS</span><br>&nbsp;&nbsp;res.<span style="border: 0px none #6f42c1; color: #6f42c1;">status</span>(<span style="border: 0px none #005cc5; color: #005cc5;">200</span>).<span style="border: 0px none #6f42c1; color: #6f42c1;">json</span>(hobbits); <span style="border: 0px none #6a737d; color: #6a737d;">// 200 means "OK"</span><br>});<br>server.<span style="border: 0px none #6f42c1; color: #6f42c1;">get</span>(<span style="border: 0px none #032f62; color: #032f62;">'/hobbits/:id'</span>, <span>(<span>req, res</span>) =&gt;</span> { <span style="border: 0px none #6a737d; color: #6a737d;">// GET EXISTING HOBBIT BY id</span><br>&nbsp;&nbsp;<span style="border: 0px none #6a737d; color: #6a737d;">// the desired id comes in the URL, and is found in `req.params.id`</span><br>&nbsp;&nbsp;res.<span style="border: 0px none #6f42c1; color: #6f42c1;">status</span>(<span style="border: 0px none #005cc5; color: #005cc5;">200</span>).<span style="border: 0px none #6f42c1; color: #6f42c1;">json</span>(hobbits.<span style="border: 0px none #6f42c1; color: #6f42c1;">find</span>(<span><span>hob</span> =&gt;</span> hob.<span>id</span> == req.<span>params</span>.<span>id</span>));<br>});<br>server.<span style="border: 0px none #6f42c1; color: #6f42c1;">post</span>(<span style="border: 0px none #032f62; color: #032f62;">'/hobbits'</span>, <span>(<span>req, res</span>) =&gt;</span> { <span style="border: 0px none #6a737d; color: #6a737d;">// POST NEW HOBBIT</span><br>&nbsp;&nbsp;<span style="border: 0px none #6a737d; color: #6a737d;">// the desired name comes in the body, and is found in `req.body.name`</span><br>&nbsp;&nbsp;hobbits.<span style="border: 0px none #6f42c1; color: #6f42c1;">push</span>({ <span style="border: 0px none #005cc5; color: #005cc5;">id</span>: <span style="border: 0px none #6f42c1; color: #6f42c1;">getId</span>(), <span style="border: 0px none #005cc5; color: #005cc5;">name</span>: req.<span>body</span>.<span>name</span> });<br>&nbsp;&nbsp;res.<span style="border: 0px none #6f42c1; color: #6f42c1;">status</span>(<span style="border: 0px none #005cc5; color: #005cc5;">201</span>).<span style="border: 0px none #6f42c1; color: #6f42c1;">json</span>(hobbits); <span style="border: 0px none #6a737d; color: #6a737d;">// 201 means "Created"</span><br>});<br>server.<span style="border: 0px none #6f42c1; color: #6f42c1;">put</span>(<span style="border: 0px none #032f62; color: #032f62;">'/hobbits/:id'</span>, <span>(<span>req, res</span>) =&gt;</span> { <span style="border: 0px none #6a737d; color: #6a737d;">// PUT EXISTING HOBBIT</span><br>&nbsp;&nbsp;<span style="border: 0px none #6a737d; color: #6a737d;">// the id to update is in `req.params.id` and the desired name in `req.body.name`</span><br>&nbsp;&nbsp;hobbits = hobbits.<span style="border: 0px none #6f42c1; color: #6f42c1;">map</span>(<span><span>hob</span> =&gt;</span> hob.<span>id</span> == req.<span>params</span>.<span>id</span><br>&nbsp;&nbsp;&nbsp;&nbsp;? { ...hob, <span style="border: 0px none #005cc5; color: #005cc5;">name</span>: req.<span>body</span>.<span>name</span> } : hob);<br>&nbsp;&nbsp;res.<span style="border: 0px none #6f42c1; color: #6f42c1;">status</span>(<span style="border: 0px none #005cc5; color: #005cc5;">200</span>).<span style="border: 0px none #6f42c1; color: #6f42c1;">json</span>(hobbits);<br>});<br>server.<span style="border: 0px none #6f42c1; color: #6f42c1;">delete</span>(<span style="border: 0px none #032f62; color: #032f62;">'/hobbits/:id'</span>, <span>(<span>req, res</span>) =&gt;</span> { <span style="border: 0px none #6a737d; color: #6a737d;">// DELETE EXISTING HOBBIT</span><br>&nbsp;&nbsp;hobbits = hobbits.<span style="border: 0px none #6f42c1; color: #6f42c1;">filter</span>(<span><span>hob</span> =&gt;</span> hob.<span>id</span> != req.<span>params</span>.<span>id</span>);<br>&nbsp;&nbsp;res.<span style="border: 0px none #6f42c1; color: #6f42c1;">status</span>(<span style="border: 0px none #005cc5; color: #005cc5;">200</span>).<span style="border: 0px none #6f42c1; color: #6f42c1;">json</span>(hobbits);<br>});<br><br>server.<span style="border: 0px none #6f42c1; color: #6f42c1;">listen</span>(<span style="border: 0px none #005cc5; color: #005cc5;">8000</span>, <span>() =&gt;</span> <span style="border: 0px none #d73a49; color: #d73a49;">console</span>.<span style="border: 0px none #6f42c1; color: #6f42c1;">log</span>(<span style="border: 0px none #032f62; color: #032f62;">'API running on port 8000'</span>));<br></code></pre>
<h2 id="challenge">Challenge</h2>
<p>Write an endpoint that returns a list of users stored in a database—return data in <code>JSON</code> format.</p>
<p><span>Production APIs return data from a data store or external source, not from an in-memory array like we have done so far.</span></p>
<p>Your job is to create a new <code>/users</code> endpoint that returns the list of users contained in the provided database. To get the list of users, <strong>require</strong> the <code>/data/db.js</code> file into <code>index.js</code> and use its <code>.find()</code> method to get the data. The <code>.find()</code> method returns a promise. Make sure to send the response after that promise has been resolved. In case of failure, return a status code of 500 and an error message to the client.</p>
<p>Good luck!</p>
</body>
</html>